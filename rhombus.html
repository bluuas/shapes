<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Rhombus – Zerlegung wie GeoGebra</title>
<link rel="stylesheet" href="shared.css">
</head>
<body>

<nav>
    <a href="index.html">← Zurück zur Übersicht</a>
    <a href="drachen.html">Drachen</a>
    <a href="parallelogramm.html">Parallelogramm</a>
    <a href="rhombus.html" class="active">Rhombus</a>
</nav>

<h2>Fläche eines Rhombus – Zerlegung (GeoGebra-Stil)</h2>

<div id="label">Zieh mich!</div>
<input id="slider" type="range" min="0" max="1" step="0.001" value="0">

<canvas id="canvas" width="900" height="450"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const slider = document.getElementById("slider");

// === RHOMBUS PARAMETER ===
const a = 240;                   // Seitenlänge (alle Seiten gleich)
const angleDeg = 125;            // Innenwinkel an A
const angle = angleDeg * Math.PI / 180;

const A = {x: 250, y: 150};
const B = {x: A.x + a, y: A.y};

// Weitere Punkte des Rhombus
const C = {
    x: B.x + a * Math.cos(angle),
    y: B.y + a * Math.sin(angle)
};
const D = {
    x: A.x + a * Math.cos(angle),
    y: A.y + a * Math.sin(angle)
};

// Höhe des Rhombus (vertikal)
const h = Math.abs(A.y - D.y);

function draw() {
    ctx.clearRect(0,0,900,450);
    const t = Number(slider.value);

    // Schritte wie im Original
    const heightStart = 0.15;
    const colorStart  = 0.30;
    const moveStart   = 0.55;
    const endStart    = 0.80;

    // Dreieckspunkte für das linke Dreieck
    const T1 = {x:A.x, y:A.y};
    const T2 = {x:D.x, y:D.y};
    const T3 = {x:A.x, y:D.y};

    // ========= Seitenbeschriftungen =========
    ctx.font = "20px Arial";
    ctx.fillStyle = "black";

    // obere Seite immer
    ctx.fillText("a", (A.x+B.x)/2, A.y - 10);

    // linke Seite immer
    ctx.fillText("a", (A.x+D.x)/2 - 20, (A.y+D.y)/2);

    // schräge Seiten nur bis Bewegung startet
    if (t < moveStart) {
        ctx.fillText("a", (B.x+C.x)/2 + 10, (B.y+C.y)/2);
        ctx.fillText("a", (C.x+D.x)/2, (C.y+D.y)/2 + 20);
    }

    // ========= 1) Rhombus zeichnen =========
    ctx.fillStyle = "#ADD8FF";

    if (t < moveStart) {
        drawPolygon([A,B,C,D]);
    } else {
        const A_new = {x: A.x, y: A.y + h};
        drawPolygon([A, B, C, A_new]);
    }

    // ========= 2) Farbiges Dreieck vor der Bewegung =========
    if (t >= colorStart && t < moveStart) {
        ctx.fillStyle = "#5B8BFF";
        drawPolygon([T1,T2,T3]);
    }

    // ========= 3) Dreieck verschieben =========
    let dx = 0, dy = 0;

    if (t >= moveStart) {
        const moveT = Math.min((t - moveStart) / (endStart - moveStart), 1);
        dx = (B.x - A.x) * moveT;
        dy = (B.y - A.y) * moveT;

        ctx.fillStyle = "#5B8BFF";
        drawPolygon([
            {x:T1.x + dx, y:T1.y + dy},
            {x:T2.x + dx, y:T2.y + dy},
            {x:T3.x + dx, y:T3.y + dy}
        ]);
    }

    // ========= 4) Höhe + h-Beschriftung (IMMER GANZ OBEN!) =========
    if (t >= heightStart) {

        // Höhe-Linie
        ctx.beginPath();
        ctx.moveTo(A.x + dx, A.y + dy);
        ctx.lineTo(A.x + dx, A.y + h + dy);
        ctx.strokeStyle = "black";
        ctx.lineWidth = 2;
        ctx.stroke();

        // h Position — bewegt sich mit dem Dreieck
        const hx = A.x + dx - 20;
        const hy = A.y + dy + h/2;

        ctx.fillStyle = "black";
        ctx.font = "20px Arial";
        ctx.fillText("h", hx, hy);
    }

    // ========= 5) Endbeschriftung =========
    if (t >= endStart) {
        ctx.font = "26px Arial";
        ctx.fillStyle = "green";
        ctx.fillText("→ Rechteck", B.x + 40, A.y + 10);
    }
}

function drawPolygon(pts) {
    ctx.beginPath();
    ctx.moveTo(pts[0].x, pts[0].y);
    for (const p of pts.slice(1)) ctx.lineTo(p.x, p.y);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
}

slider.oninput = draw;
draw();
</script>

</body>
</html>
