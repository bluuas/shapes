<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rhombus ‚Äì Zerlegung wie GeoGebra</title>
<link rel="stylesheet" href="shared.css">
<script src="quiz-data.js"></script>
</head>
<body>

<nav>
    <a href="index.html">‚Üê Zur√ºck zur √úbersicht</a>
    <a href="drachen.html">Drachen</a>
    <a href="parallelogramm.html">Parallelogramm</a>
    <a href="rhombus.html" class="active">Rhombus</a>
</nav>

<h2>Fl√§che eines Rhombus ‚Äì Zerlegung (GeoGebra-Stil)</h2>

<div id="label">Zieh mich!</div>
<input id="slider" type="range" min="0" max="1" step="0.001" value="0">

<div class="canvas-container">
    <canvas id="canvas"></canvas>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const slider = document.getElementById("slider");

// === RHOMBUS PARAMETER ===
const baseA = 180;
const baseH = 120;
const baseOffsetX = 250;
const baseOffsetY = 150;

function getScaleFactor() {
    return canvas.width / 900;
}

// Make canvas responsive
function resizeCanvas() {
    const container = canvas.parentElement;
    const containerWidth = container.clientWidth;
    const maxWidth = 900;
    const maxHeight = 450;
    
    canvas.width = Math.min(containerWidth, maxWidth);
    canvas.height = canvas.width * (maxHeight / maxWidth);
    
    draw();
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const t = Number(slider.value);
    
    const scale = getScaleFactor();
    const a = baseA * scale;
    const h = baseH * scale;
    const dx = Math.sqrt(a*a - h*h);
    
    const offsetX = baseOffsetX * scale;
    const offsetY = baseOffsetY * scale;
    
    const A = {x: offsetX, y: offsetY};
    const B = {x: offsetX + a, y: offsetY};
    const C = {x: offsetX + a - dx, y: offsetY + h};
    const D = {x: offsetX - dx, y: offsetY + h};

    // Schritte wie im Original
    const heightStart = 0.15;
    const colorStart  = 0.30;
    const moveStart   = 0.55;
    const endStart    = 0.80;

    // Dreieckspunkte f√ºr das linke Dreieck
    const T1 = {x:A.x, y:A.y};
    const T2 = {x:D.x, y:D.y};
    const T3 = {x:A.x, y:D.y};

    // ========= Seitenbeschriftungen =========
    const fontSize = Math.max(12, 20 * scale);
    ctx.font = fontSize + "px Arial";
    ctx.fillStyle = "black";

    // obere Seite immer
    ctx.fillText("a", (A.x+B.x)/2, A.y - 10 * scale);

    // linke Seite immer
    ctx.fillText("a", (A.x+D.x)/2 - 20 * scale, (A.y+D.y)/2);

    // schr√§ge Seiten nur bis Bewegung startet
    if (t < moveStart) {
        ctx.fillText("a", (B.x+C.x)/2 + 10 * scale, (B.y+C.y)/2);
        ctx.fillText("a", (C.x+D.x)/2, (C.y+D.y)/2 + 20 * scale);
    }

    // ========= 1) Rhombus zeichnen =========
    ctx.fillStyle = "#ADD8FF";

    if (t < moveStart) {
        drawPolygon([A,B,C,D]);
    } else {
        const A_new = {x: A.x, y: A.y + h};
        drawPolygon([A, B, C, A_new]);
    }

    // ========= 2) Farbiges Dreieck vor der Bewegung =========
    if (t >= colorStart && t < moveStart) {
        ctx.fillStyle = "#5B8BFF";
        drawPolygon([T1,T2,T3]);
    }

    // ========= 3) Dreieck verschieben =========
    let moveDx = 0, moveDy = 0;

    if (t >= moveStart) {
        const moveT = Math.min((t - moveStart) / (endStart - moveStart), 1);
        moveDx = (B.x - A.x) * moveT;
        moveDy = (B.y - A.y) * moveT;

        ctx.fillStyle = "#5B8BFF";
        drawPolygon([
            {x:T1.x + moveDx, y:T1.y + moveDy},
            {x:T2.x + moveDx, y:T2.y + moveDy},
            {x:T3.x + moveDx, y:T3.y + moveDy}
        ]);
    }

    // ========= 4) H√∂he + h-Beschriftung (IMMER GANZ OBEN!) =========
    if (t >= heightStart) {

        // H√∂he-Linie
        ctx.beginPath();
        ctx.moveTo(A.x + moveDx, A.y + moveDy);
        ctx.lineTo(A.x + moveDx, A.y + h + moveDy);
        ctx.strokeStyle = "black";
        ctx.lineWidth = 2;
        ctx.stroke();

        // h Position ‚Äî bewegt sich mit dem Dreieck
        const hx = A.x + moveDx - 20 * scale;
        const hy = A.y + moveDy + h/2;

        ctx.fillStyle = "black";
        const fontSize = Math.max(12, 20 * scale);
        ctx.font = fontSize + "px Arial";
        ctx.fillText("h", hx, hy);
    }

    // ========= 5) Endbeschriftung =========
    if (t >= endStart) {
        const fontSize = Math.max(16, 26 * scale);
        ctx.font = fontSize + "px Arial";
        ctx.fillStyle = "green";
        ctx.fillText("‚Üí Rechteck", B.x + 40 * scale, A.y + 10 * scale);
    }
}

function drawPolygon(pts) {
    ctx.strokeStyle = "#333";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(pts[0].x, pts[0].y);
    for (const p of pts.slice(1)) ctx.lineTo(p.x, p.y);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
}

slider.oninput = draw;
draw();
</script>

<!-- Quiz Section -->
<style>
.quiz-section {
    max-width: 800px;
    margin: 60px auto 40px;
    padding: 0 20px;
}

.quiz-card {
    background: white;
    border: 2px solid #333;
    border-radius: 8px;
    padding: 30px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.quiz-canvas-container {
    text-align: center;
    margin: 20px 0;
    overflow-x: auto;
}

.quiz-canvas-container canvas {
    max-width: 100%;
    height: auto;
}

.quiz-dimensions {
    background: #f0f0f0;
    padding: 15px;
    border-radius: 4px;
    margin: 20px 0;
    font-size: 18px;
    line-height: 1.8;
}

.quiz-hint {
    background: #fff9e6;
    border-left: 4px solid #ffc107;
    padding: 15px;
    margin: 20px 0;
    font-style: italic;
    color: #666;
}

.quiz-answer-section {
    margin: 20px 0;
}

.quiz-input-group {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 15px 0;
    flex-wrap: wrap;
}

.quiz-input-group label {
    font-size: 18px;
    font-weight: bold;
}

.quiz-input-group input {
    padding: 10px;
    font-size: 18px;
    border: 2px solid #333;
    border-radius: 4px;
    width: 150px;
    max-width: 100%;
}

.quiz-btn {
    padding: 12px 30px;
    font-size: 18px;
    background: #333;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 5px 5px 5px 0;
}

.quiz-btn:hover {
    opacity: 0.9;
}

.quiz-btn-secondary {
    padding: 10px 20px;
    font-size: 16px;
    background: #6c757d;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 5px 5px 5px 0;
}

.quiz-btn-success {
    padding: 10px 25px;
    font-size: 16px;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 5px 5px 5px 0;
}

.quiz-result {
    display: none;
    margin-top: 15px;
    padding: 15px;
    border-radius: 4px;
    font-size: 18px;
    font-weight: bold;
}

.quiz-solution {
    display: none;
    background: #e7f3ff;
    border-left: 4px solid #0050FF;
    padding: 15px;
    margin-top: 15px;
    line-height: 1.8;
}

@media (max-width: 768px) {
    .quiz-card {
        padding: 20px;
    }
    
    .quiz-dimensions,
    .quiz-hint {
        font-size: 16px;
    }
    
    .quiz-input-group {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .quiz-input-group input {
        width: 100%;
        max-width: 300px;
    }
    
    .quiz-btn {
        width: 100%;
        max-width: 300px;
    }
    
    .quiz-btn-secondary,
    .quiz-btn-success {
        width: 100%;
        max-width: 300px;
        margin: 5px 0;
    }
}
</style>

<div class="quiz-section">
    <h2 style="color: #333; margin-bottom: 20px;">üßÆ Quiz: Berechne die Fl√§che!</h2>
    
    <div class="quiz-card">
        <div class="quiz-canvas-container">
            <canvas id="rhombus-quiz-canvas"></canvas>
        </div>
        
        <div class="quiz-dimensions">
            <strong>Gegeben:</strong><br>
            Seitenl√§nge a = <span id="rhombus-a">12</span> cm<br>
            H√∂he h = <span id="rhombus-h">8</span> cm
        </div>
        
        <div class="quiz-hint">
            üí° Tipp: Die Formel f√ºr die Fl√§che eines Rhombus lautet: A = a √ó h
        </div>
        
        <div class="quiz-answer-section">
            <div class="quiz-input-group">
                <label for="rhombus-answer">Deine Antwort:</label>
                <input type="number" id="rhombus-answer" placeholder="z.B. 96">
                <span style="font-size: 18px;">cm¬≤</span>
                <button onclick="checkRhombusQuiz()" class="quiz-btn">Pr√ºfen</button>
            </div>
            
            <div id="rhombus-result" class="quiz-result"></div>
            
            <button onclick="toggleRhombusSolution()" class="quiz-btn-secondary">L√∂sung anzeigen</button>
            <button onclick="newRhombusProblem()" class="quiz-btn-success">Neue Aufgabe</button>
            
            <div id="rhombus-solution" class="quiz-solution">
                <strong>L√∂sung:</strong><br>
                A = a √ó h<br>
                A = <span id="rhombus-sol-a">12</span> cm √ó <span id="rhombus-sol-h">8</span> cm<br>
                A = <strong><span id="rhombus-sol-answer">96</span> cm¬≤</strong>
            </div>
        </div>
    </div>
</div>

<script>
// Initialize quiz for rhombus
currentProblems.rhombus = 0;

function drawRhombusQuiz() {
    const canvas = document.getElementById('rhombus-quiz-canvas');
    const ctx = canvas.getContext('2d');
    
    // Make quiz canvas responsive
    const container = canvas.parentElement;
    const containerWidth = container.clientWidth;
    const maxWidth = 900;
    canvas.width = Math.min(containerWidth, maxWidth);
    canvas.height = canvas.width * 0.5;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    const problem = getCurrentProblem('rhombus');
    const scale = canvas.width / 300;
    const a = problem.a * 10 * scale;
    const h = problem.h * 10 * scale;
    const dx = Math.sqrt(a*a - h*h);
    
    const offsetX = 150 * scale;
    const offsetY = 50 * scale;
    
    // Draw rhombus with horizontal top/bottom (matching main animation)
    const A = {x: offsetX, y: offsetY};
    const B = {x: offsetX + a, y: offsetY};
    const C = {x: offsetX + a - dx, y: offsetY + h};
    const D = {x: offsetX - dx, y: offsetY + h};
    
    ctx.fillStyle = '#ADD8FF';
    ctx.strokeStyle = '#333';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(A.x, A.y);
    ctx.lineTo(B.x, B.y);
    ctx.lineTo(C.x, C.y);
    ctx.lineTo(D.x, D.y);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
    
    // Draw dashed height line
    ctx.strokeStyle = '#666';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([5, 5]);
    ctx.beginPath();
    ctx.moveTo(A.x, A.y);
    ctx.lineTo(A.x, A.y + h);
    ctx.stroke();
    // Draw dashed baseline
    ctx.beginPath();
    ctx.moveTo(D.x, D.y);
    ctx.lineTo(A.x, A.y + h);
    ctx.stroke();
    ctx.setLineDash([]);
    
    // Labels
    const fontSize = Math.max(12, 16 * scale);
    ctx.font = fontSize + 'px Arial';
    ctx.fillStyle = '#333';
    ctx.fillText('a = ' + problem.a + ' cm', (A.x + B.x) / 2 - 30 * scale, A.y - 10 * scale);
    ctx.fillText('h = ' + problem.h + ' cm', A.x - 50 * scale, A.y + h / 2);
}

function updateRhombusQuizDisplay() {
    const problem = getCurrentProblem('rhombus');
    document.getElementById('rhombus-a').textContent = problem.a;
    document.getElementById('rhombus-h').textContent = problem.h;
    document.getElementById('rhombus-sol-a').textContent = problem.a;
    document.getElementById('rhombus-sol-h').textContent = problem.h;
    document.getElementById('rhombus-sol-answer').textContent = problem.answer;
    drawRhombusQuiz();
}

window.addEventListener('resize', function() {
    if (document.getElementById('rhombus-quiz-canvas')) {
        drawRhombusQuiz();
    }
});

function newRhombusProblem() {
    getNextProblem('rhombus');
    updateRhombusQuizDisplay();
    document.getElementById('rhombus-answer').value = '';
    document.getElementById('rhombus-result').style.display = 'none';
    document.getElementById('rhombus-solution').style.display = 'none';
}

function checkRhombusQuiz() {
    const answer = Number(document.getElementById('rhombus-answer').value);
    const correct = getCurrentProblem('rhombus').answer;
    const result = document.getElementById('rhombus-result');
    
    if (answer === correct) {
        result.style.display = 'block';
        result.style.background = '#d4edda';
        result.style.color = '#155724';
        result.style.border = '2px solid #28a745';
        result.innerHTML = '‚úì Richtig! Fantastisch! üéâ';
    } else if (answer) {
        result.style.display = 'block';
        result.style.background = '#f8d7da';
        result.style.color = '#721c24';
        result.style.border = '2px solid #dc3545';
        result.innerHTML = '‚úó Nicht ganz richtig. Versuche es nochmal!';
    } else {
        result.style.display = 'none';
    }
}

function toggleRhombusSolution() {
    const solution = document.getElementById('rhombus-solution');
    solution.style.display = solution.style.display === 'none' ? 'block' : 'none';
}

document.getElementById('rhombus-answer').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') checkRhombusQuiz();
});

// Initialize quiz
drawRhombusQuiz();
</script>

</body>
</html>